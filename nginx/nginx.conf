server {
    # Listen for incoming connections on port 80 (HTTP)
    listen 80;

    # Define the server name (domain) that this configuration applies to
    server_name api.weebuns.blog;

    location / {
        # Allow cross-origin requests from 'https://weebuns.blog'
        add_header 'Access-Control-Allow-Origin' 'https://weebuns.blog';

        # Forward all incoming requests to the backend server running on port 8080
        proxy_pass http://127.0.0.1:8080;

        # Use HTTP/1.1 for better performance with WebSockets and keep-alive connections
        proxy_http_version 1.1;

        # Allow WebSocket upgrades (useful for real-time applications)
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';

        # Preserve the original Host header for the backend server
        proxy_set_header Host $host;

        # Bypass cache for upgraded WebSocket connections
        proxy_cache_bypass $http_upgrade;

        # Forward the real client IP address to the backend server
        proxy_set_header X-Real-IP $remote_addr;
    }
}
